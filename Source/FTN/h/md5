/* ******************************************************************************************************************************************************** */
/* MD5 Implementation for CRAM-MD5 Authentication                                                                                                           */
/* Based on RFC 1321                                                                                                                                        */
/* ******************************************************************************************************************************************************** */

#ifndef MD5_H
#define MD5_H

#include <stddef.h>

typedef struct {
    unsigned int state[4];      /* state (ABCD) */
    unsigned int count[2];      /* number of bits, modulo 2^64 (lsb first) */
    unsigned char buffer[64];   /* input buffer */
} MD5_CTX;

void MD5_Init(MD5_CTX *context);
void MD5_Update(MD5_CTX *context, const unsigned char *input, size_t inputLen);
void MD5_Final(unsigned char digest[16], MD5_CTX *context);

/* Convenience function to compute MD5 of a buffer */
void MD5(const unsigned char *input, size_t len, unsigned char digest[16]);

/* HMAC-MD5 for CRAM-MD5 authentication */
void HMAC_MD5(const unsigned char *key, size_t key_len,
              const unsigned char *data, size_t data_len,
              unsigned char digest[16]);

#endif
