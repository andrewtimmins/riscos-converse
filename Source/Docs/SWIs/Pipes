
--------------------------------------------------------------------------------

Converse Pipes Technical Summary

--------------------------------------------------------------------------------

* SWI chunk base: 0x5AA00 (registered as ConversePipes_). The module exposes a
  compact set of helpers for status polling plus byte and block transfers.
* Thirty-two logical lines are available (0..31). Each line owns two 4096-byte
  circular buffers: input (producer to consumer) and output (consumer to
  producer).
* Bits 7 (0x80) and 6 (0x40) of the status byte report watermark thresholds
  for flow control. These flags allow producers and consumers to coordinate
  data transfer rates efficiently.
* Interfaces in `examples/c/` mirror common workflows such as tailing a line,
  pushing argv text, or bridging two lines.

SWI Decoding Table
------------------
  ConversePipes_ReadStatus       0x5AA00
  ConversePipes_WriteStatus      0x5AA01
  ConversePipes_InputStatus      0x5AA02
  ConversePipes_InputRead        0x5AA03
  ConversePipes_OutputStatus     0x5AA04
  ConversePipes_OutputWrite      0x5AA05
  ConversePipes_ClearInput       0x5AA06
  ConversePipes_ClearOutput      0x5AA07
  ConversePipes_InputWrite       0x5AA08
  ConversePipes_OutputRead       0x5AA09
  ConversePipes_ResetState       0x5AA0A
  ConversePipes_InputPeek        0x5AA0B
  ConversePipes_OutputPeek       0x5AA0C
  ConversePipes_InputWriteBlock  0x5AA0D
  ConversePipes_OutputReadBlock  0x5AA0E

--------------------------------------------------------------------------------

WATERMARKS

Watermarks are flow control indicators that help applications manage buffer
levels without constant polling of exact byte counts. They use hysteresis to
provide stable "stop" and "resume" signals for data transfer.

* Input High (Bit 7): Indicates the input buffer is filling up (>= 75%).
  Producers should suspend writing to prevent blocking. The flag clears only
  when the buffer drains below 50%.

* Output Low (Bit 6): Indicates the output buffer is running low on free space
  (<= 25% free). Consumers should prioritize reading to free up space. The flag
  clears when free space recovers to 50%.

--------------------------------------------------------------------------------

SWI USAGE GUIDELINES

* R0 always carries the line index (0..31). The module validates the range on
  entry and returns -1 for any invalid line.
* All SWIs return 0 on success unless they report a byte value or byte count; a
  result of -1 indicates the request could not proceed (retry later).
* The module never uses carry or V flags. Callers should poll for readiness via
  the status helpers before attempting bulk transfers.
* InputRead/InputWrite operate on the inbound buffer (producer to consumer).
  OutputWrite/OutputRead targets the outbound buffer.
* Prefer the block variants when moving large bursts. A return value of 0 means
  the buffer is full or empty; back off and try again rather than busy looping.

--------------------------------------------------------------------------------

0x5AA00 - ConversePipes_ReadStatus

On Entry:
            R0: Line index (0..31).

On Exit:
            R0: Current status byte for the requested line, or -1 for failure.

Notes:
            * Bits 6 and 7 convey buffer watermark hints managed by the module.

--------------------------------------------------------------------------------

0x5AA01 - ConversePipes_WriteStatus

On Entry:
            R0: Line index (0..31).
            R1: New status byte (low 8 bits honoured).

On Exit:
            R0: 0 for success, -1 for failure.

--------------------------------------------------------------------------------

0x5AA02 - ConversePipes_InputStatus

On Entry:
            R0: Line index (0..31).

On Exit:
            R0: Number of bytes waiting in the input buffer, or -1 for failure.

--------------------------------------------------------------------------------

0x5AA03 - ConversePipes_InputRead

On Entry:
            R0: Line index (0..31).

On Exit:
            R0: Next byte (0..255) removed from the input buffer, or -1 when empty.

--------------------------------------------------------------------------------

0x5AA04 - ConversePipes_OutputStatus

On Entry:
            R0: Line index (0..31).

On Exit:
            R0: Number of free byte slots in the output buffer, or -1 for failure.

--------------------------------------------------------------------------------

0x5AA05 - ConversePipes_OutputWrite

On Entry:
            R0: Line index (0..31).
            R1: Byte value to queue (low 8 bits honoured).

On Exit:
            R0: 0 when stored, -1 when the buffer is full or the call fails.

--------------------------------------------------------------------------------

0x5AA06 - ConversePipes_ClearInput

On Entry:
            R0: Line index (0..31).

On Exit:
            R0: 0 when the input buffer counters are reset, -1 for failure.

--------------------------------------------------------------------------------

0x5AA07 - ConversePipes_ClearOutput

On Entry:
            R0: Line index (0..31).

On Exit:
            R0: 0 when the output buffer counters are reset, -1 for failure.

--------------------------------------------------------------------------------

0x5AA08 - ConversePipes_InputWrite

On Entry:
            R0: Line index (0..31).
            R1: Byte value to push into the input buffer.

On Exit:
            R0: 0 when accepted, -1 when the buffer is full (4096-byte limit) or on failure.

--------------------------------------------------------------------------------

0x5AA09 - ConversePipes_OutputRead

On Entry:
            R0: Line index (0..31).

On Exit:
            R0: Next byte removed from the output buffer, or -1 when empty.

--------------------------------------------------------------------------------

0x5AA0A - ConversePipes_ResetState

On Entry:
            R0: Line index (0..31).

On Exit:
            R0: 0 when the stored status byte is cleared, -1 for failure.

--------------------------------------------------------------------------------

0x5AA0B - ConversePipes_InputPeek

On Entry:
            R0: Line index (0..31).

On Exit:
            R0: Next byte from the input buffer without removing it, or -1 when empty.

--------------------------------------------------------------------------------

0x5AA0C - ConversePipes_OutputPeek

On Entry:
            R0: Line index (0..31).

On Exit:
            R0: Next byte from the output buffer without removing it, or -1 when empty.

--------------------------------------------------------------------------------

0x5AA0D - ConversePipes_InputWriteBlock

On Entry:
            R0: Line index (0..31).
            R1: Pointer to buffer containing data to send.
            R2: Maximum number of bytes to copy.

On Exit:
            R0: Number of bytes copied (0..R2) or -1 for invalid input.

Notes:
            * Caller memory is copied directly; keep it writable for the entire SWI.
            * A return of 0 indicates the buffer is full - sleep or retry later.

--------------------------------------------------------------------------------

0x5AA0E - ConversePipes_OutputReadBlock

On Entry:
            R0: Line index (0..31).
            R1: Pointer to buffer for received data.
            R2: Maximum number of bytes to copy.

On Exit:
            R0: Number of bytes copied (0..R2) or -1 for invalid input.

Notes:
            * Returns immediately when no bytes are buffered so callers can poll.
            * Combine with InputWriteBlock for efficient pump loops.

--------------------------------------------------------------------------------

CLI COMMANDS

  *Pipes_Status : Dumps per-line head and tail pointers, free space, and watermark
                  flags. Output is mirrored to the system console via Report_Text0.

--------------------------------------------------------------------------------
